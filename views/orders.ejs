<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lezzetli App | Orders</title>
  <link rel="stylesheet" href="/css/output.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-gray-50">
  <div class="flex h-screen overflow-hidden">
    <%- include('partials/sidebar') %>

      <div class="relative flex flex-col flex-1 overflow-x-hidden overflow-y-auto">
        <%- include('partials/header') %>

          <main class="flex-1 p-6">
            <div class="max-w-7xl mx-auto">
              <!-- Header Card -->
              <div class="bg-gradient-to-r from-[#2B588D] to-[#5FA8A1] rounded-2xl shadow-lg mb-8 overflow-hidden">
                <div class="px-8 py-6">
                  <div class="flex flex-col md:flex-row md:items-center justify-between">
                    <div class="mb-4 md:mb-0">
                      <h2 class="text-3xl font-bold text-white mb-2">Orders</h2>
                      <p class="text-white/90 text-sm">
                        Manage and track all Employees orders
                      </p>
                    </div>
                    <div class="flex items-center space-x-4">
                      <div class="bg-white/20 backdrop-blur-sm rounded-xl px-4 py-2">
                        <p class="text-sm text-white font-medium">
                          <i class="fas fa-shopping-cart mr-2"></i>
                          <span class="font-bold"><%= orders.length %></span> Total Orders
                        </p>
                      </div>
                      <div class="hidden md:flex items-center space-x-3">
                        <div class="bg-white/10 rounded-lg px-3 py-1.5">
                          <p class="text-xs text-white font-medium">
                            <i class="fas fa-clock mr-1"></i>
                            <%= orders.filter(o => o.status === 'pending').length %> Pending
                          </p>
                        </div>
                        <div class="bg-white/10 rounded-lg px-3 py-1.5">
                          <p class="text-xs text-white font-medium">
                            <i class="fas fa-check-circle mr-1"></i>
                            <%= orders.filter(o => o.status === 'completed').length %> Completed
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Main Content Card -->
              <div class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
                <!-- Filters and Search -->
                <div class="p-6 border-b border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="relative">
                      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-gray-400"></i>
                      </div>
                      <input type="text" placeholder="Search orders..." 
                        class="pl-10 w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#66BE6E] focus:border-transparent transition-all duration-200"
                        id="searchInput">
                    </div>
                    <!-- <div>
                      <select class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#66BE6E] focus:border-transparent transition-all duration-200 bg-white" id="statusFilter">
                        <option value="">All Status</option>
                        <option value="pending">Pending</option>
                        <option value="processing">Processing</option>
                        <option value="completed">Completed</option>
                        <option value="cancelled">Cancelled</option>
                      </select>
                    </div> -->
                    <!-- <div>
                      <select class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#66BE6E] focus:border-transparent transition-all duration-200 bg-white" id="paymentFilter">
                        <option value="">All Payments</option>
                        <option value="pending">Payment Pending</option>
                        <option value="paid">Paid</option>
                        <option value="failed">Payment Failed</option>
                      </select>
                    </div> -->
                    <!-- <div>
                      <select class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#66BE6E] focus:border-transparent transition-all duration-200 bg-white" id="paidByFilter">
                        <option value="">Paid By</option>
                        <option value="employee">Employee</option>
                        <option value="company">Company</option>
                        <option value="self">Self</option>
                      </select>
                    </div> -->
                  </div>
                </div>

                <!-- Orders List -->
                <div class="p-6">
                  <% if (orders.length === 0) { %>
                    <div class="text-center py-12">
                      <div class="mx-auto h-24 w-24 text-gray-400 mb-6">
                        <i class="fas fa-shopping-cart text-5xl"></i>
                      </div>
                      <h3 class="text-xl font-semibold text-gray-900 mb-2">No orders found</h3>
                      <p class="text-gray-500">No orders have been placed yet</p>
                    </div>
                  <% } else { %>
                    <%
                      // Sort orders by date (most recent first)
                      const sortedOrders = orders.sort((a, b) => {
                        const dateA = a.createdAt || a.date || 0;
                        const dateB = b.createdAt || b.date || 0;
                        return new Date(dateB) - new Date(dateA);
                      });
                      
                      // Pagination
                      const itemsPerPage = 5;
                      const currentPage = parseInt(page) || 1;
                      const startIndex = (currentPage - 1) * itemsPerPage;
                      const endIndex = Math.min(startIndex + itemsPerPage, sortedOrders.length);
                      const paginatedOrders = sortedOrders.slice(startIndex, endIndex);
                      const totalPages = Math.ceil(sortedOrders.length / itemsPerPage);
                    %>
                    
                    <div class="space-y-4">
                      <% paginatedOrders.forEach((order, index) => { %>
                        <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 overflow-hidden order-card" 
                             data-status="<%= order.status %>"
                             data-payment="<%= order.payment_status %>"
                             data-paidby="<%= order.paid_by %>">
                          <!-- Order Header -->
                          <div class="px-6 py-4 bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200">
                            <div class="flex flex-col md:flex-row md:items-center justify-between">
                              <div class="flex items-center space-x-4">
                                <div class="h-10 w-10 flex-shrink-0 bg-gradient-to-br from-[#2B588D]/10 to-[#5FA8A1]/10 rounded-lg flex items-center justify-center">
                                  <i class="fas fa-receipt text-[#2B588D]"></i>
                                </div>
                                <div>
                                  <h3 class="text-lg font-semibold text-gray-900">
                                    Order #<%= index + 1 %>
                                  </h3>
                                  <div class="flex items-center space-x-3 mt-1">
                                    <span class="text-sm text-gray-600">
                                      <i class="far fa-calendar mr-1"></i>
                                      <%= new Date(order.createdAt).toLocaleDateString() %>
                                    </span>
                                    <span class="text-sm text-gray-600">
                                      <i class="far fa-clock mr-1"></i>
                                      <%= new Date(order.createdAt || order.date || Date.now()).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) %>
                                    </span>
                                  </div>
                                </div>
                              </div>
                              <div class="mt-3 md:mt-0">
                                <div class="text-right">
                                  <div class="text-2xl font-bold text-gray-900">
                                    $<%= order.total_amount || '0.00' %>
                                  </div>
                                  <div class="text-sm text-gray-500">Total Amount</div>
                                </div>
                              </div>
                            </div>
                          </div>

                          <!-- Order Details -->
                          <div class="px-6 py-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                              <!-- Company Info -->
                              <div>
                                <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
                                  <i class="fas fa-building mr-1"></i> Company
                                </h4>
                                <div class="flex items-center">
                                  <div class="h-8 w-8 flex-shrink-0 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-building text-blue-600 text-sm"></i>
                                  </div>
                                  <div>
                                    <p class="text-sm font-medium text-gray-900">
                                      <%= order.company?.name || 'N/A' %>
                                    </p>
                                    <p class="text-xs text-gray-500">
                                      <%= order.company?.company_code || 'No code' %>
                                    </p>
                                  </div>
                                </div>
                              </div>

                              <!-- Customer Info -->
                              <div>
                                <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
                                  <i class="fas fa-user mr-1"></i> Customer
                                </h4>
                                <div class="flex items-center">
                                  <div class="h-8 w-8 flex-shrink-0 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-user text-purple-600 text-sm"></i>
                                  </div>
                                  <div>
                                    <p class="text-sm font-medium text-gray-900">
                                      <%= order.user?.name || 'N/A' %>
                                    </p>
                                    <p class="text-xs text-gray-500">
                                      <%= order.user?.email || 'No email' %>
                                    </p>
                                  </div>
                                </div>
                              </div>

                              <!-- Menu Info -->
                              <div>
                                <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
                                  <i class="fas fa-utensils mr-1"></i> Menu
                                </h4>
                                <div class="flex items-center">
                                  <div class="h-8 w-8 flex-shrink-0 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-utensils text-emerald-600 text-sm"></i>
                                  </div>
                                  <div>
                                    <p class="text-sm font-medium text-gray-900">
                                      <%= order.menu?.type || 'Daily' %> Menu
                                    </p>
                                    <p class="text-xs text-gray-500 capitalize">
                                      <%= order.menu?.mealType || 'N/A' %> • 
                                      <%= order.menu?.date ? new Date(order.menu.date).toLocaleDateString() : 'N/A' %>
                                    </p>
                                  </div>
                                </div>
                              </div>

                              <!-- Payment Info -->
                              <div>
                                <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
                                  <i class="fas fa-credit-card mr-1"></i> Payment
                                </h4>
                                <div class="flex items-center">
                                  <div class="h-8 w-8 flex-shrink-0 bg-gradient-to-br from-amber-50 to-amber-100 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-credit-card text-amber-600 text-sm"></i>
                                  </div>
                                  <div>
                                    <p class="text-sm font-medium text-gray-900 capitalize">
                                      <%= order.paid_by || 'N/A' %>
                                    </p>
                                    <p class="text-xs text-gray-500">
                                      <%= order.payment_status || 'N/A' %>
                                    </p>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <!-- Order Items -->
                            <div class="mt-6 pt-6 border-t border-gray-200">
                              <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">
                                <i class="fas fa-list-ul mr-1"></i> Order Items (<%= order.items?.length || 0 %>)
                              </h4>
                              <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <% if (order.items && order.items.length > 0) { %>
                                  <% order.items.forEach((item, idx) => { %>
                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                      <div class="flex items-center">
                                        <div class="h-8 w-8 flex-shrink-0 <%= item.type === 'veg' ? 'bg-green-50' : 'bg-red-50' %> rounded-lg flex items-center justify-center mr-3">
                                          <div class="h-2 w-2 <%= item.type === 'veg' ? 'bg-green-500' : 'bg-red-500' %> rounded-full"></div>
                                        </div>
                                        <div>
                                          <p class="text-sm font-medium text-gray-900">
                                            <%= item.name %>
                                          </p>
                                          <div class="flex items-center space-x-2">
                                            <p class="text-xs text-gray-500 capitalize">
                                              <%= item.type %>
                                            </p>
                                            <span class="text-xs text-gray-400">•</span>
                                            <p class="text-xs text-gray-500">
                                              Qty: <%= item.quantity || 1 %>
                                            </p>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="text-right">
                                        <p class="text-sm font-semibold text-gray-900">
                                          $<%= item.price || '0.00' %>
                                        </p>
                                      </div>
                                    </div>
                                  <% }); %>
                                <% } else { %>
                                  <p class="text-sm text-gray-500 italic">No items in this order</p>
                                <% } %>
                              </div>
                            </div>
                          </div>

                          <!-- Order Footer -->
                          <div class="px-6 py-4 bg-gray-50 border-t border-gray-200">
                            <div class="flex flex-col md:flex-row md:items-center justify-between">
                              <!-- Status Badges -->
                              <div class="flex flex-wrap gap-3">
                                <!-- Order Status -->
                                <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold
                                  <%= order.status === 'completed' ? 'bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-800 border border-emerald-200' : 
                                     order.status === 'processing' ? 'bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 border border-blue-200' :
                                     order.status === 'cancelled' ? 'bg-gradient-to-r from-rose-50 to-rose-100 text-rose-800 border border-rose-200' :
                                     'bg-gradient-to-r from-amber-50 to-amber-100 text-amber-800 border border-amber-200' %>">
                                  <div class="h-2 w-2 rounded-full mr-2 
                                    <%= order.status === 'completed' ? 'bg-emerald-500' : 
                                       order.status === 'processing' ? 'bg-blue-500' :
                                       order.status === 'cancelled' ? 'bg-rose-500' :
                                       'bg-amber-500' %>"></div>
                                  <%= order.status || 'pending' %>
                                </span>

                                <!-- Payment Status -->
                                <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold
                                  <%= order.payment_status === 'paid' ? 'bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-800 border border-emerald-200' :
                                     order.payment_status === 'failed' ? 'bg-gradient-to-r from-rose-50 to-rose-100 text-rose-800 border border-rose-200' :
                                     'bg-gradient-to-r from-amber-50 to-amber-100 text-amber-800 border border-amber-200' %>">
                                  <i class="<%= order.payment_status === 'paid' ? 'fas fa-check-circle' : 
                                            order.payment_status === 'failed' ? 'fas fa-times-circle' : 
                                            'fas fa-clock' %> mr-2 text-xs"></i>
                                  <%= order.payment_status || 'pending' %>
                                </span>

                                <!-- Paid By -->
                                <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold bg-gradient-to-r from-indigo-50 to-indigo-100 text-indigo-800 border border-indigo-200">
                                  <i class="fas fa-user-tag mr-2 text-xs"></i>
                                  <%= order.paid_by || 'employee' %>
                                </span>
                              </div>

                              <!-- Action Buttons -->
                              <div class="mt-4 md:mt-0 flex space-x-3">
                                <!-- Start Processing Button - Only show to admin -->
                                <% if (order.status === 'pending' && admin.role !== 'company') { %>
                                  <button onclick="updateOrderStatus('<%= order.id %>', 'processing')"
                                    class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 rounded-lg hover:from-blue-100 hover:to-blue-200 hover:text-blue-800 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5 border border-blue-200">
                                    <i class="fas fa-play mr-2"></i>
                                    Start Processing
                                  </button>
                                <% } %>
                                
                                <!-- Mark Complete Button - Show to both admin and company -->
                                <% if (order.status === 'processing') { %>
                                  <button onclick="updateOrderStatus('<%= order.id %>', 'completed')"
                                    class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 rounded-lg hover:from-emerald-100 hover:to-emerald-200 hover:text-emerald-800 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5 border border-emerald-200">
                                    <i class="fas fa-check mr-2"></i>
                                    Mark Complete
                                  </button>
                                <% } %>

                                <!-- Mark Paid Button - Show to both admin and company -->
                                <% if (order.payment_status === 'pending') { %>
                                  <button onclick="markAsPaid('<%= order.id %>')"
                                    class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-purple-50 to-purple-100 text-purple-700 rounded-lg hover:from-purple-100 hover:to-purple-200 hover:text-purple-800 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5 border border-purple-200">
                                    <i class="fas fa-credit-card mr-2"></i>
                                    Mark Paid
                                  </button>
                                <% } %>
                                <button onclick="viewOrderDetails('<%= order.id %>')"
                                  class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 rounded-lg hover:from-gray-100 hover:to-gray-200 hover:text-gray-800 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5 border border-gray-200">
                                  <i class="fas fa-eye mr-2"></i>
                                  View Details
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      <% }); %>
                    </div>

                    <!-- Pagination -->
                    <div class="mt-8">
                      <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="text-sm text-gray-600 mb-4 md:mb-0">
                          <p>
                            Showing <span class="font-semibold text-gray-800">
                              <%= startIndex + 1 %>
                            </span> to <span class="font-semibold text-gray-800">
                              <%= endIndex %>
                            </span> of <span class="font-semibold text-gray-800">
                              <%= sortedOrders.length %>
                            </span> orders
                          </p>
                        </div>
                        
                        <div class="flex items-center space-x-2">
                          <!-- Previous Button -->
                          <% if (currentPage > 1) { %>
                            <a href="/orders?page=<%= currentPage - 1 %>"
                              class="inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 hover:shadow-sm transition-all duration-200">
                              <i class="fas fa-chevron-left mr-2"></i>
                              Previous
                            </a>
                          <% } %>

                          <!-- Page Numbers -->
                          <% 
                            const maxVisiblePages = 5;
                            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
                            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
                            
                            if (endPage - startPage + 1 < maxVisiblePages) {
                              startPage = Math.max(1, endPage - maxVisiblePages + 1);
                            }
                            
                            for (let i = startPage; i <= endPage; i++) { 
                          %>
                            <a href="/orders?page=<%= i %>"
                              class="inline-flex items-center justify-center h-10 w-10 rounded-lg text-sm font-medium transition-all duration-200 <%= i === currentPage ? 'bg-gradient-to-r from-[#2B588D] to-[#5FA8A1] text-white shadow-md' : 'bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:shadow-sm' %>">
                              <%= i %>
                            </a>
                          <% } %>

                          <!-- Next Button -->
                          <% if (currentPage < totalPages) { %>
                            <a href="/orders?page=<%= currentPage + 1 %>"
                              class="inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 hover:shadow-sm transition-all duration-200">
                              Next
                              <i class="fas fa-chevron-right ml-2"></i>
                            </a>
                          <% } %>
                        </div>
                      </div>
                    </div>
                  <% } %>
                </div>

                <!-- Stats Summary -->
                <div class="bg-gray-50 px-6 py-4 border-t border-gray-200">
                  <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="bg-white p-4 rounded-xl border border-gray-200">
                      <p class="text-sm text-gray-500 mb-1">Total Orders</p>
                      <p class="text-2xl font-bold text-gray-900"><%= orders.length %></p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-gray-200">
                      <p class="text-sm text-gray-500 mb-1">Pending Orders</p>
                      <p class="text-2xl font-bold text-amber-600"><%= orders.filter(o => o.status === 'pending').length %></p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-gray-200">
                      <p class="text-sm text-gray-500 mb-1">Completed Orders</p>
                      <p class="text-2xl font-bold text-emerald-600"><%= orders.filter(o => o.status === 'completed').length %></p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-gray-200">
                      <p class="text-sm text-gray-500 mb-1">Total Revenue</p>
                      <p class="text-2xl font-bold text-[#2B588D]">
                        $<%= orders.reduce((sum, order) => sum + parseFloat(order.total_amount || 0), 0).toFixed(2) %>
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </main>
      </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    // Filter orders
    function filterOrders() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const statusFilter = document.getElementById('statusFilter').value;
      const paymentFilter = document.getElementById('paymentFilter').value;
      const paidByFilter = document.getElementById('paidByFilter').value;
      
      const orderCards = document.querySelectorAll('.order-card');
      
      orderCards.forEach(card => {
        let show = true;
        const status = card.getAttribute('data-status');
        const payment = card.getAttribute('data-payment');
        const paidby = card.getAttribute('data-paidby');
        
        // Search filter
        if (searchTerm) {
          const text = card.textContent.toLowerCase();
          if (!text.includes(searchTerm)) {
            show = false;
          }
        }
        
        // Status filter
        if (statusFilter && status !== statusFilter) {
          show = false;
        }
        
        // Payment filter
        if (paymentFilter && payment !== paymentFilter) {
          show = false;
        }
        
        // Paid By filter
        if (paidByFilter && paidby !== paidByFilter) {
          show = false;
        }
        
        if (show) {
          card.style.display = 'block';
          setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
          }, 10);
        } else {
          card.style.opacity = '0';
          card.style.transform = 'translateY(-10px)';
          setTimeout(() => {
            card.style.display = 'none';
          }, 300);
        }
      });
    }
    
    // Initialize filters
    document.addEventListener('DOMContentLoaded', function() {
      const searchInput = document.getElementById('searchInput');
      const statusFilter = document.getElementById('statusFilter');
      const paymentFilter = document.getElementById('paymentFilter');
      const paidByFilter = document.getElementById('paidByFilter');
      
      if (searchInput) searchInput.addEventListener('input', filterOrders);
      if (statusFilter) statusFilter.addEventListener('change', filterOrders);
      if (paymentFilter) paymentFilter.addEventListener('change', filterOrders);
      if (paidByFilter) paidByFilter.addEventListener('change', filterOrders);
    });
    
// Order status update - Using MVC route
function updateOrderStatus(orderId, status) {
  Swal.fire({
    title: 'Update Order Status?',
    html: `Are you sure you want to mark this order as <strong>${status}</strong>?`,
    icon: 'question',
    showCancelButton: true,
    confirmButtonColor: '#2B588D',
    cancelButtonColor: '#6b7280',
    confirmButtonText: `Yes, mark as ${status}`,
    cancelButtonText: 'Cancel',
    reverseButtons: true,
    customClass: {
      popup: 'rounded-2xl',
      confirmButton: 'px-6 py-2 rounded-lg font-semibold',
      cancelButton: 'px-6 py-2 rounded-lg font-semibold'
    }
  }).then((result) => {
    if (result.isConfirmed) {
      // Create a form and submit it
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = `/orders/status/${orderId}`;
      
      // Add status field
      const statusInput = document.createElement('input');
      statusInput.type = 'hidden';
      statusInput.name = 'status';
      statusInput.value = status;
      form.appendChild(statusInput);
      
      // Submit the form
      document.body.appendChild(form);
      form.submit();
    }
  });
}

// Mark as paid - Using MVC route
function markAsPaid(orderId) {
  Swal.fire({
    title: 'Mark as Paid?',
    html: 'Are you sure you want to mark this order as paid?',
    icon: 'question',
    showCancelButton: true,
    confirmButtonColor: '#66BE6E',
    cancelButtonColor: '#6b7280',
    confirmButtonText: 'Yes, mark as paid',
    cancelButtonText: 'Cancel',
    reverseButtons: true,
    customClass: {
      popup: 'rounded-2xl',
      confirmButton: 'px-6 py-2 rounded-lg font-semibold',
      cancelButton: 'px-6 py-2 rounded-lg font-semibold'
    }
  }).then((result) => {
    if (result.isConfirmed) {
      // Create a form and submit it
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = `/orders/payment/${orderId}`;      
      // Add payment_status field
      const statusInput = document.createElement('input');
      statusInput.type = 'hidden';
      statusInput.name = 'payment_status';
      statusInput.value = 'paid';
      form.appendChild(statusInput);
      
      // Submit the form
      document.body.appendChild(form);
      form.submit();
    }
  });
}

    
    // View order details
    function viewOrderDetails(orderId) {
      // This would typically open a modal or navigate to order detail page
      window.location.href = `/orders/view/${orderId}`;
    }
  </script>

  <%- include('partials/script') %>
</body>

</html>