<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lezzetli App | Menu Items</title>
  <link rel="stylesheet" href="/css/output.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-gray-50">
  <div class="flex h-screen overflow-hidden">
    <%- include('partials/sidebar') %>

      <div class="relative flex flex-col flex-1 overflow-x-hidden overflow-y-auto">
        <%- include('partials/header') %>

          <main class="flex-1 p-6">
            <div class="max-w-6xl mx-auto">
              <!-- Header Card -->
              <div class="bg-gradient-to-r from-[#2B588D] to-[#5FA8A1] rounded-2xl shadow-lg mb-8 overflow-hidden">
                <div class="px-8 py-6">
                  <div class="flex flex-col md:flex-row md:items-center justify-between">
                    <div class="mb-4 md:mb-0">
                      <h2 class="text-3xl font-bold text-white mb-2">Menu Items</h2>
                      <p class="text-white/90 text-sm">
                        Manage all menu items in your restaurant
                      </p>
                    </div>
                    <div class="flex items-center space-x-4">
                      <div class="bg-white/20 backdrop-blur-sm rounded-xl px-4 py-2">
                        <p class="text-sm text-white font-medium">
                          <i class="fas fa-utensils mr-2"></i>
                          <span class="font-bold"><%= menu_items.length %></span> Total Items
                        </p>
                      </div>
                      <a href="/menu_items/add"
                        class="inline-flex items-center px-6 py-3 bg-white text-[#2B588D] font-semibold rounded-xl hover:bg-gray-100 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-0.5">
                        <i class="fas fa-plus-circle mr-3 text-lg"></i>
                        Add New Item
                      </a>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Main Content Card -->
              <div class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
                <!-- Table Container -->
                <div class="p-6">
                  <!-- Search and Filter Section (Optional for future) -->
                  <!-- <div class="mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-search text-gray-400"></i>
                        </div>
                        <input type="text" placeholder="Search items..." 
                          class="pl-10 w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#66BE6E] focus:border-transparent transition-all duration-200"
                          disabled>
                      </div>
                      <div>
                        <select 
                          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#66BE6E] focus:border-transparent transition-all duration-200 bg-white"
                          disabled>
                          <option value="">All Types</option>
                          <option value="veg">Veg</option>
                          <option value="non-veg">Non-Veg</option>
                        </select>
                      </div>
                      <div>
                        <select 
                          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#66BE6E] focus:border-transparent transition-all duration-200 bg-white"
                          disabled>
                          <option value="">All Status</option>
                          <option value="active">Active</option>
                          <option value="inactive">Inactive</option>
                        </select>
                      </div>
                    </div>
                  </div> -->

                  <!-- Table -->
                  <div class="overflow-hidden rounded-xl border border-gray-200">
                    <table class="w-full">
                      <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                        <tr>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <div class="flex items-center">
                              <span>#</span>
                              <i class="fas fa-sort ml-2 text-gray-400"></i>
                            </div>
                          </th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <div class="flex items-center">
                              <span>Item Details</span>
                              <i class="fas fa-sort ml-2 text-gray-400"></i>
                            </div>
                          </th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            Price
                          </th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            Type
                          </th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            Status
                          </th>
                          <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            Actions
                          </th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200 bg-white">
                        <% const itemsPerPage=10; const currentPage=1; const
                          startIndex=(currentPage - 1) * itemsPerPage; const endIndex=Math.min(startIndex +
                          itemsPerPage, menu_items.length); const paginatedItems=menu_items.slice(startIndex, endIndex);
                          paginatedItems.forEach((pack, index)=> { %>
                          <tr class="hover:bg-gray-50/50 transition-colors duration-200 group">
                            <td class="px-6 py-4 whitespace-nowrap">
                              <div class="flex items-center">
                                <div class="h-8 w-8 flex items-center justify-center bg-gradient-to-br from-[#2B588D]/10 to-[#5FA8A1]/10 rounded-lg">
                                  <span class="text-sm font-semibold text-gray-700">
                                    <%= index + startIndex + 1 %>
                                  </span>
                                </div>
                              </div>
                            </td>
                            <td class="px-6 py-4">
                              <div class="flex items-center">
                                <div class="h-10 w-10 flex-shrink-0 mr-4 bg-gradient-to-br from-[#2B588D]/20 to-[#5FA8A1]/20 rounded-lg flex items-center justify-center">
                                  <i class="fas fa-utensil-spoon text-[#2B588D]"></i>
                                </div>
                                <div>
                                  <div class="text-sm font-semibold text-gray-900">
                                    <%= pack.name.toUpperCase() %>
                                  </div>
                                  <div class="text-xs text-gray-500">
                                    ID: <%= pack.id.slice(0, 8) %>...
                                  </div>
                                </div>
                              </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                              <div class="flex items-center">
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-green-50 to-green-100 text-green-800 border border-green-200">
                                  <i class="fas fa-dollar-sign mr-1 text-xs"></i>
                                  <%= pack.price %>
                                </span>
                              </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                              <% if(pack.type=='non-veg' ) { %>
                                <div class="flex items-center">
                                  <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold bg-gradient-to-r from-red-50 to-red-100 text-red-800 border border-red-200 shadow-sm">
                                    <div class="h-2 w-2 bg-red-500 rounded-full mr-2"></div>
                                    Non-Veg
                                  </span>
                                </div>
                                <% } else { %>
                                  <div class="flex items-center">
                                    <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold bg-gradient-to-r from-green-50 to-green-100 text-green-800 border border-green-200 shadow-sm">
                                      <div class="h-2 w-2 bg-green-500 rounded-full mr-2"></div>
                                      Veg
                                    </span>
                                  </div>
                                  <% } %>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                              <% if(pack.is_active) { %>
                                <div class="flex items-center">
                                  <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-800 border border-emerald-200 shadow-sm">
                                    <div class="h-2 w-2 bg-emerald-500 rounded-full mr-2 animate-pulse"></div>
                                    Active
                                  </span>
                                </div>
                                <% } else { %>
                                  <div class="flex items-center">
                                    <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold bg-gradient-to-r from-rose-50 to-rose-100 text-rose-800 border border-rose-200 shadow-sm">
                                      <div class="h-2 w-2 bg-rose-500 rounded-full mr-2"></div>
                                      Inactive
                                    </span>
                                  </div>
                                  <% } %>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-right">
                              <div class="flex items-center justify-end space-x-3">
                                <a href="/menu_items/edit/<%= pack.id %>"
                                  class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-indigo-50 to-indigo-100 text-indigo-700 rounded-lg hover:from-indigo-100 hover:to-indigo-200 hover:text-indigo-800 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5 border border-indigo-200">
                                  <i class="fas fa-edit mr-2"></i>
                                  Edit
                                </a>
                                <button onclick="confirmDelete('<%= pack.id %>')"
                                  class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-rose-50 to-rose-100 text-rose-700 rounded-lg hover:from-rose-100 hover:to-rose-200 hover:text-rose-800 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5 border border-rose-200">
                                  <i class="fas fa-trash mr-2"></i>
                                  Delete
                                </button>
                              </div>
                            </td>
                          </tr>
                          <% }) %>
                      </tbody>
                    </table>
                  </div>

                  <!-- Hidden delete forms -->
                  <% paginatedItems.forEach((pack)=> { %>
                    <form action="/menu_items/delete/<%= pack.id %>" method="POST" class="hidden"
                      id="deleteForm-<%= pack.id %>">
                    </form>
                    <% }) %>

                  <!-- Pagination -->
                  <div class="mt-8 bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6">
                    <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0">
                      <div class="text-sm text-gray-600">
                        <p>
                          Showing <span class="font-semibold text-gray-800">
                            <%= startIndex + 1 %>
                          </span> to <span class="font-semibold text-gray-800">
                            <%= endIndex %>
                          </span> of <span class="font-semibold text-gray-800">
                            <%= menu_items.length %>
                          </span> items
                        </p>
                      </div>
                      <div class="flex items-center space-x-2">
                        <% const totalPages=Math.ceil(menu_items.length / itemsPerPage); const maxVisiblePages=5; let
                          startPage=Math.max(1, currentPage - Math.floor(maxVisiblePages / 2)); let
                          endPage=Math.min(totalPages, startPage + maxVisiblePages - 1); if (endPage - startPage + 1 <
                            maxVisiblePages) { startPage=Math.max(1, endPage - maxVisiblePages + 1); } %>

                          <!-- Previous Button -->
                          <% if (currentPage> 1) { %>
                            <a href="/menu_items?page=<%= currentPage - 1 %>"
                              class="inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 hover:shadow-sm transition-all duration-200">
                              <i class="fas fa-chevron-left mr-2"></i>
                              Previous
                            </a>
                            <% } %>

                              <!-- Page Numbers -->
                              <% for (let i=startPage; i <=endPage; i++) { %>
                                <a href="/menu_items?page=<%= i %>"
                                  class="inline-flex items-center justify-center h-10 w-10 rounded-lg text-sm font-medium transition-all duration-200 <%= i === currentPage ? 'bg-gradient-to-r from-[#2B588D] to-[#5FA8A1] text-white shadow-md' : 'bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:shadow-sm' %>">
                                  <%= i %>
                                </a>
                                <% } %>

                                  <!-- Next Button -->
                                  <% if (currentPage < totalPages) { %>
                                    <a href="/menu_items?page=<%= currentPage + 1 %>"
                                      class="inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 hover:shadow-sm transition-all duration-200">
                                      Next
                                      <i class="fas fa-chevron-right ml-2"></i>
                                    </a>
                                    <% } %>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Empty State (Optional) -->
                <% if (menu_items.length===0) { %>
                  <div class="text-center py-12">
                    <div class="mx-auto h-24 w-24 text-gray-400 mb-6">
                      <i class="fas fa-utensils text-5xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">No menu items found</h3>
                    <p class="text-gray-500 mb-6">Get started by creating your first menu item</p>
                    <a href="/add"
                      class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-[#2B588D] to-[#5FA8A1] text-white font-semibold rounded-lg hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5">
                      <i class="fas fa-plus-circle mr-3 text-lg"></i>
                      Add Your First Item
                    </a>
                  </div>
                  <% } %>
              </div>
            </div>
          </main>
      </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    function confirmDelete(packId) {
      Swal.fire({
        title: 'Delete Menu Item?',
        html: `<p class="text-gray-600 mb-4">Are you sure you want to delete this menu item?</p>
               <p class="text-sm text-gray-500">This action cannot be undone.</p>`,
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#e3342f',
        cancelButtonColor: '#6b7280',
        confirmButtonText: 'Yes, delete it',
        cancelButtonText: 'Cancel',
        reverseButtons: true,
        customClass: {
          popup: 'rounded-2xl',
          confirmButton: 'px-6 py-2 rounded-lg font-semibold',
          cancelButton: 'px-6 py-2 rounded-lg font-semibold'
        }
      }).then((result) => {
        if (result.isConfirmed) {
          document.getElementById(`deleteForm-${packId}`).submit();
        }
      });
    }

    // Search functionality (placeholder for future implementation)
    document.addEventListener('DOMContentLoaded', function() {
      const searchInput = document.querySelector('input[placeholder="Search items..."]');
      const typeFilter = document.querySelector('select[value=""]');
      const statusFilter = document.querySelector('select[value="All Status"]');
      
      // These are disabled for now but can be enabled with backend support
      console.log('Search and filter functionality ready for implementation');
    });
  </script>

  <%- include('partials/script') %>
</body>

</html>