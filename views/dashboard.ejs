<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard | Wedding Panel</title>
  <link href="/css/output.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-dayjs@1"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap');

    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
    }

    /* h1,
    h2,
    h3,
    h4,
    .serif-font {
      font-family: 'Playfair Display', serif;
    } */

    .glass-effect {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
    }

    .hover-card-rise {
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .hover-card-rise:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px -5px rgba(243, 199, 191, 0.3);
    }

    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: #e2e8f0;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #cbd5e1;
    }
  </style>
</head>

<body class="bg-[#faf7f6] text-slate-800">
  <div class="flex h-screen overflow-hidden selection:bg-[#FF5E62] selection:text-white">
    <%- include('partials/sidebar') %>

      <div class="flex flex-col flex-1 overflow-x-hidden overflow-y-auto relative">
        <%- include('partials/header') %>

          <main class="w-full max-w-[1920px] mx-auto p-4 md:p-6 lg:p-8">

            <!-- Welcome Banner -->
            <div
              class="relative overflow-hidden rounded-[2.5rem] bg-white shadow-xl shadow-[#F3C7BF]/10 mb-10 border border-white/50 group">
              <div
                class="absolute top-0 right-0 w-96 h-96 bg-gradient-to-br from-[#FF5E62]/5 to-[#F3C7BF]/10 rounded-full blur-[64px] -mr-20 -mt-20 pointer-events-none">
              </div>
              <div
                class="absolute bottom-0 left-0 w-72 h-72 bg-gradient-to-tr from-[#FF5E62]/5 to-transparent rounded-full blur-[64px] -ml-20 -mb-20 pointer-events-none">
              </div>

              <div class="relative px-8 py-10 flex flex-col md:flex-row md:items-center justify-between z-10">
                <div class="max-w-2xl">
                  <div
                    class="inline-flex items-center space-x-2 bg-[#F3C7BF]/20 text-[#FF5E62] px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider mb-4">
                    <span class="w-2 h-2 rounded-full bg-[#FF5E62] animate-pulse"></span>
                    <span>Live Overview</span>
                  </div>
                  <h1 class="text-4xl lg:text-5xl font-extrabold text-slate-900 tracking-tight mb-3">
                    Hello, <span class="bg-clip-text text-transparent bg-gradient-to-r from-[#FF5E62] to-[#ff9966]">
                      <%= admin.name.split(' ')[0] %></span> ðŸ‘‹
                            </h1>
                            <p class="text-slate-500 text-lg">
                                Welcome back. Here' s your wedding overview. </p>
                </div>

                <div
                  class="mt-8 md:mt-0 flex items-center bg-white/60 backdrop-blur-md border border-white/60 rounded-2xl p-4 shadow-sm hover:shadow-md transition-shadow">
                  <div
                    class="p-3 bg-gradient-to-br from-[#FF5E62] to-[#ff9966] rounded-xl mr-4 text-white shadow-lg shadow-[#FF5E62]/30">
                    <i class="far fa-calendar-check text-xl"></i>
                  </div>
                  <div>
                    <p class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-0.5">Today's Date</p>
                    <p class="text-lg font-bold text-slate-800">
                      <%= new Date().toLocaleDateString('en-US', { weekday: 'long' , month: 'short' , day: 'numeric' })
                        %>
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Stats Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">

              <!-- Bookings Card -->
              <div
                class="bg-white rounded-[2rem] p-6 shadow-[0_4px_20px_-2px_rgba(0,0,0,0.02)] border border-slate-100/60 hover-card-rise group relative overflow-hidden text-center">
                <div class="absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity">
                  <i class="fas fa-ticket-alt text-6xl text-blue-500 transform rotate-12"></i>
                </div>
                <div
                  class="mx-auto w-14 h-14 bg-blue-50 text-blue-500 rounded-2xl flex items-center justify-center mb-4 group-hover:bg-blue-500 group-hover:text-white transition-all duration-300 shadow-sm">
                  <i class="fas fa-ticket-alt text-xl"></i>
                </div>
                <h3 class="text-slate-400 text-xs font-bold uppercase tracking-widest mb-1">Total Bookings</h3>
                <p class="text-3xl font-extrabold text-slate-800">
                  <%= dashboard.totalBookings %>
                </p>
              </div>

              <!-- Guests Card -->
              <div
                class="bg-white rounded-[2rem] p-6 shadow-[0_4px_20px_-2px_rgba(0,0,0,0.02)] border border-slate-100/60 hover-card-rise group relative overflow-hidden text-center">
                <div class="absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity">
                  <i class="fas fa-users text-6xl text-emerald-500 transform rotate-12"></i>
                </div>
                <div
                  class="mx-auto w-14 h-14 bg-emerald-50 text-emerald-500 rounded-2xl flex items-center justify-center mb-4 group-hover:bg-emerald-500 group-hover:text-white transition-all duration-300 shadow-sm">
                  <i class="fas fa-users text-xl"></i>
                </div>
                <h3 class="text-slate-400 text-xs font-bold uppercase tracking-widest mb-1">Total Guests</h3>
                <p class="text-3xl font-extrabold text-slate-800">
                  <%= dashboard.totalGuests %>
                </p>
              </div>

              <!-- Couples Card -->
              <div
                class="bg-white rounded-[2rem] p-6 shadow-[0_4px_20px_-2px_rgba(0,0,0,0.02)] border border-slate-100/60 hover-card-rise group relative overflow-hidden text-center">
                <div class="absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity">
                  <i class="fas fa-heart text-6xl text-purple-500 transform rotate-12"></i>
                </div>
                <div
                  class="mx-auto w-14 h-14 bg-purple-50 text-purple-500 rounded-2xl flex items-center justify-center mb-4 group-hover:bg-purple-500 group-hover:text-white transition-all duration-300 shadow-sm">
                  <i class="fas fa-heart text-xl"></i>
                </div>
                <h3 class="text-slate-400 text-xs font-bold uppercase tracking-widest mb-1">Total Couples</h3>
                <p class="text-3xl font-extrabold text-slate-800">
                  <%= dashboard.totalCouples %>
                </p>
              </div>

              <!-- Events Card -->
              <div
                class="bg-white rounded-[2rem] p-6 shadow-[0_4px_20px_-2px_rgba(0,0,0,0.02)] border border-slate-100/60 hover-card-rise group relative overflow-hidden text-center">
                <div class="absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity">
                  <i class="fas fa-glass-cheers text-6xl text-[#FF5E62] transform rotate-12"></i>
                </div>
                <div
                  class="mx-auto w-14 h-14 bg-orange-50 text-[#FF5E62] rounded-2xl flex items-center justify-center mb-4 group-hover:bg-[#FF5E62] group-hover:text-white transition-all duration-300 shadow-sm">
                  <i class="fas fa-glass-cheers text-xl"></i>
                </div>
                <h3 class="text-slate-400 text-xs font-bold uppercase tracking-widest mb-1">Total Events</h3>
                <p class="text-3xl font-extrabold text-slate-800">
                  <%= dashboard.totalEvents %>
                </p>
              </div>
            </div>

            <!-- Lists Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">

              <!-- Recent Couples -->
              <div
                class="bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/40 border border-slate-100 flex flex-col h-full overflow-hidden">
                <div
                  class="px-8 py-6 border-b border-slate-50 flex items-center justify-between bg-gradient-to-r from-white to-slate-50/50">
                  <div class="flex items-center gap-3">
                    <div class="p-2.5 bg-purple-50 text-purple-600 rounded-xl">
                      <i class="fas fa-heart text-lg"></i>
                    </div>
                    <h2 class="text-lg font-bold text-slate-800">Recent Couples</h2>
                  </div>
                  <a href="/users"
                    class="text-xs font-bold text-[#FF5E62] hover:underline uppercase tracking-wider">View All</a>
                </div>
                <div class="p-6">
                  <% if (dashboard.recentCouples.length===0) { %>
                    <div class="text-center py-10 text-slate-400">No recent couples.</div>
                    <% } else { %>
                      <div class="space-y-4">
                        <% dashboard.recentCouples.forEach(couple=> { %>
                          <div
                            class="flex items-center justify-between p-4 rounded-2xl border border-slate-50 bg-slate-50/30 hover:bg-purple-50/30 hover:border-purple-100 transition-all duration-300">
                            <div class="flex items-center gap-4">
                              <div
                                class="w-12 h-12 rounded-full bg-gradient-to-br from-[#F3C7BF] to-[#FF5E62] flex items-center justify-center text-white font-bold text-lg">
                                <%= couple.partner1Name?.charAt(0) || 'C' %>
                              </div>
                              <div>
                                <p class="text-sm font-bold text-slate-800">
                                  <%= (couple.partner1Name && couple.partner2Name) ? couple.partner1Name + ' & ' +
                                    couple.partner2Name : couple.name || 'Unknown' %>
                                </p>
                                <p class="text-xs text-slate-500">
                                  <%= couple.email || 'No email' %>
                                </p>
                              </div>
                            </div>
                            <div class="text-right">
                              <a href="/users/view/<%= couple.id %>"
                                class="text-xs font-bold text-slate-400 hover:text-purple-600">View</a>
                            </div>
                          </div>
                          <% }); %>
                      </div>
                      <% } %>
                </div>
              </div>

              <!-- Recent Guests -->
              <div
                class="bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/40 border border-slate-100 flex flex-col h-full overflow-hidden">
                <div
                  class="px-8 py-6 border-b border-slate-50 flex items-center justify-between bg-gradient-to-r from-white to-slate-50/50">
                  <div class="flex items-center gap-3">
                    <div class="p-2.5 bg-emerald-50 text-emerald-600 rounded-xl">
                      <i class="fas fa-user-friends text-lg"></i>
                    </div>
                    <h2 class="text-lg font-bold text-slate-800">Recent Guests</h2>
                  </div>
                  <a href="/users/guests"
                    class="text-xs font-bold text-emerald-500 hover:underline uppercase tracking-wider">View All</a>
                </div>
                <div class="p-6">
                  <% if (dashboard.recentGuests.length===0) { %>
                    <div class="text-center py-10 text-slate-400">No recent guests.</div>
                    <% } else { %>
                      <div class="space-y-4">
                        <% dashboard.recentGuests.forEach(guest=> { %>
                          <div
                            class="flex items-center justify-between p-4 rounded-2xl border border-slate-50 bg-slate-50/30 hover:bg-emerald-50/30 hover:border-emerald-100 transition-all duration-300">
                            <div class="flex items-center gap-4">
                              <div
                                class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center text-emerald-600 font-bold text-lg border-2 border-white shadow-sm">
                                <%= guest.fullName?.charAt(0) || 'G' %>
                              </div>
                              <div>
                                <p class="text-sm font-bold text-slate-800">
                                  <%= guest.fullName || 'Unknown' %>
                                </p>
                                <p class="text-xs text-slate-500">
                                  <%= guest.email || guest.phoneNumber || 'N/A' %>
                                </p>
                              </div>
                            </div>
                            <div class="text-right">
                              <a href="/users/viewGuest/<%= guest.id %>"
                                class="text-xs font-bold text-slate-400 hover:text-emerald-600">View</a>
                            </div>
                          </div>
                          <% }); %>
                      </div>
                      <% } %>
                </div>
              </div>
            </div>

            <!-- Top 5 Events -->
            <div
              class="bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/40 border border-slate-100 overflow-hidden mb-10">
              <div
                class="px-8 py-6 border-b border-slate-50 flex items-center justify-between bg-gradient-to-r from-white to-slate-50/50">
                <div class="flex items-center gap-3">
                  <div class="p-2.5 bg-orange-50 text-[#FF5E62] rounded-xl">
                    <i class="fas fa-calendar-alt text-lg"></i>
                  </div>
                  <h2 class="text-lg font-bold text-slate-800">Top 5 Events</h2>
                </div>
              </div>
              <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                  <thead>
                    <tr class="border-b border-slate-100 text-xs font-bold text-slate-400 uppercase tracking-wider">
                      <th class="px-8 py-5">Event Detail</th>
                      <th class="px-8 py-5">Venue</th>
                      <th class="px-8 py-5 text-right">Date</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-slate-50">
                    <% if (dashboard.topEvents.length===0) { %>
                      <tr>
                        <td colspan="3" class="px-8 py-10 text-center text-slate-400">No events found.</td>
                      </tr>
                      <% } else { %>
                        <% dashboard.topEvents.forEach(event=> { %>
                          <tr class="group hover:bg-slate-50/50 transition-colors">
                            <td class="px-8 py-4">
                              <div class="flex items-center gap-4">
                                <div
                                  class="w-10 h-10 rounded-xl bg-orange-50 flex items-center justify-center text-[#FF5E62]">
                                  <i class="fas fa-star"></i>
                                </div>
                                <div>
                                  <p
                                    class="text-sm font-bold text-slate-800 group-hover:text-[#FF5E62] transition-colors">
                                    <%= event.brideName %> & <%= event.groomName %>
                                  </p>
                                  <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">
                                    <%= event.isPublished ? 'Published' : 'Draft' %>
                                  </p>
                                </div>
                              </div>
                            </td>
                            <td class="px-8 py-4">
                              <span class="text-sm font-medium text-slate-600">
                                <%= event.venue || 'No Venue' %>
                              </span>
                            </td>
                            <td class="px-8 py-4 text-right">
                              <span class="text-sm font-bold text-slate-800">
                                <%= event.weddingDate ? new Date(event.weddingDate._seconds ? event.weddingDate._seconds
                                  * 1000 : event.weddingDate).toLocaleDateString() : 'TBD' %>
                              </span>
                            </td>
                          </tr>
                          <% }); %>
                            <% } %>
                  </tbody>
                </table>
              </div>
            </div>

          </main>
      </div>
  </div>

  <%- include('partials/script') %>
</body>

</html>